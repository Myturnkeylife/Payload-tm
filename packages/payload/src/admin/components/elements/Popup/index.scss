@import '../../../scss/styles.scss';

.popup {
  --popup-bg: var(--theme-input-bg);
  --popup-text: var(--theme-text);
  --popup-caret-size: 10px;
  --popup-x-padding: 0;
  --popup-y-padding: calc(var(--base) * 0.33);
  position: relative;

  &__content {
    position: absolute;
    background: var(--popup-bg);
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    z-index: var(--z-popup);
    max-width: calc(100vw - #{$baseline});
    color: var(--popup-text);
    border: 1px solid var(--theme-border-color);
    border-radius: 2px;
  }

  &__caret {
    position: absolute;
    top: calc(100% - 1px);
    border: var(--popup-caret-size) solid transparent;
    border-top-color: var(--popup-bg);
  }

  &__wrap {
    overflow: hidden;
  }

  .popup__scroll-pad-size--medium {
    --popup-x-padding: calc(var(--base) * 0.5);
  }

  .popup__scroll-pad-size--large {
    --popup-x-padding: calc(var(--base) * 1.5);
  }

  .popup__scroll {
    overflow-y: auto;
    white-space: nowrap;
    width: calc(100% + var(--scrollbar-width) + var(--popup-x-padding));
    padding-top: var(--popup-y-padding);
    padding-bottom: var(--popup-y-padding);
    padding-left: var(--popup-x-padding);
    padding-right: var(--popup-x-padding);
  }

  &--show-scrollbar {
    .popup__scroll {
      padding-right: 0;
      width: 100%;
    }
  }

  &:focus,
  &:active {
    outline: none;
  }

  ////////////////////////////////
  // SIZE
  ////////////////////////////////

  &--size-small {
    .popup__scroll {
      [dir='rtl'] & {
        padding-left: calc(var(--scrollbar-width) + var(--popup-x-padding));
        padding-right: var(--popup-x-padding);
      }
    }

    .popup__content {
      @include shadow-m;
    }

    &.popup--h-align-left {
      .popup__content {
        left: - base(0.5);
      }

      .popup__caret {
        left: base(0.425);
      }
    }
  }

  &--size-large {
    .popup__content {
      @include shadow-lg;
    }

    .popup__scroll {
      padding: base(1) calc(var(--scrollbar-width) + #{base(1.5)}) base(1) base(1.5);
    }
  }

  &--size-wide {
    .popup__content {
      @include shadow-m;
    }

    .popup__caret {
      border: var(--popup-caret-size) solid transparent;
      border-top-color: var(--theme-input-bg);
    }

    .popup__scroll {
      padding: base(0.25) base(0.5);
    }

    &.popup--align-left {
      .popup__content {
        left: - base(0.5);
      }

      .popup__caret {
        left: base(0.425);
      }
    }
  }

  ////////////////////////////////
  // HORIZONTAL ALIGNMENT
  ////////////////////////////////

  &--h-align-left {
    .popup__content {
      left: - base(1.75);
    }

    .popup__caret {
      left: base(1.75);
    }
  }

  &--h-align-center {
    .popup__content {
      left: 50%;
      transform: translateX(-50%);
    }

    .popup__caret {
      left: 50%;
      transform: translateX(-50%);
    }
  }

  &--h-align-right {
    .popup__content {
      right: - base(1.75);
      [dir='rtl'] & {
        right: - base(0.75);
      }
    }

    .popup__caret {
      right: base(1.75);
      [dir='rtl'] & {
        right: base(0.75);
      }
    }
  }

  ////////////////////////////////
  // VERTICAL ALIGNMENT
  ////////////////////////////////

  &--v-align-top {
    .popup__content {
      @include shadow-lg;
      bottom: calc(100% + var(--popup-caret-size));
    }
  }

  &--v-align-bottom {
    .popup__content {
      @include shadow-lg-top;
      top: calc(100% + var(--popup-caret-size));
    }

    .popup__caret {
      top: unset;
      bottom: calc(100% - 1px);
      border-top-color: transparent !important;
      border-bottom-color: var(--popup-bg);
    }
  }

  ////////////////////////////////
  // ACTIVE
  ////////////////////////////////

  &--active {
    .popup__content {
      opacity: 1;
      visibility: visible;
      pointer-events: all;
    }
  }

  @include mid-break {
    &__scroll,
    &--size-large .popup__scroll {
      padding: base(0.75);
      padding-right: calc(var(--scrollbar-width) + #{base(0.75)});
    }

    &--h-align-left {
      .popup__content {
        left: - base(0.5);
      }

      .popup__caret {
        left: base(0.5);
      }
    }

    &--h-align-center {
      .popup__content {
        left: 50%;
        transform: translateX(-0%);
      }

      .popup__caret {
        left: 50%;
        transform: translateX(-0%);
      }
    }

    &--h-align-right {
      .popup__content {
        right: - base(0.5);
      }

      .popup__caret {
        right: base(0.5);
      }
    }

    &--force-h-align-left {
      .popup__content {
        left: - base(0.5);
        right: unset;
        transform: unset;
      }

      .popup__caret {
        left: base(0.5);
        right: unset;
        transform: unset;
      }
    }

    &--force-h-align-right {
      .popup__content {
        right: - base(0.5);
        left: unset;
        transform: unset;
      }

      .popup__caret {
        right: base(0.5);
        left: unset;
        transform: unset;
      }
    }
  }
}
